<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Attendance Portal</title>
    <style>
        /* General styling for the page */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #181212;
        }  
        .neon-border{
            border: 10px solid #03A9F4; /* neon blue color */
  box-shadow: 0 0 10px #03A9F4; /* glow effect */
  animation: animate 2s step-start; }
        @keyframes animate 
        {
            0%
            {
                transform: rotate(0deg);
            }
            100%
            {
                transform: rotate(360deg);
            }
        }
        /* Styling for the navbar */
        .navbar {
            background-color: #333;
            color: #ffffff;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-brand h1 {
            margin: 0;
            font-size: 1.5em;
        }

        .navbar-links p {
            margin: 0;
        }

        /* Container styling */
        .container {
            padding: 200px;
        }

        #formSection {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        #formSection h2 {
            margin-top: 0;
        }

        /* Styling for buttons */
        button {
            background-color: #090909;
            color: white;
            padding: 10px;
            margin: 10px 0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        /* Styling for form labels and inputs */
        label {
            display: block;
            margin: 10px 0 5px;
        }

        select, input[type="date"], input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        /* Styling for the students list */
        #studentsList {
            list-style-type: none;
            padding: 0;
        }

        #studentsList li {
            padding: 10px;
            border: 1px solid #ccc;
            margin-bottom: 5px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Styling for the summary section */
        #summarySection {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }

        #summarySection h3 {
            margin-top: 0;
        }

        /* Styling for the result section */
        #resultSection {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }

        #resultSection h3 {
            margin-top: 0;
        }

        /* Popup styling */
        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            z-index: 999;
            border-radius: 5px;
        }

        .popup h2 {
            margin-top: 0;
        }

        .popup label {
            display: block;
            margin: 10px 0 5px;
        }

        .popup input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    
    <div class="navbar">
        <div class="navbar-brand">
            <h1>Student Attendance Portal</h1>
        </div>
        <div class="navbar-links">
            <p>Academic Year: <span id="academicYear">2024</span></p>
        </div>
    </div>
    
    <div class="container">
        <div class="neon-border">
        <div id="formSection">
            <h2>Mark Attendance</h2>
            <button id="addStudentButton" onclick="showAddStudentForm()">Add Student</button>
            <button id="addClassButton" onclick="showAddClassForm()">Add Class</button>

            <label for="classSelector">Class:</label>
            <select id="classSelector" required onchange="showStudentsList()">
                <!-- Populate classes dynamically -->
            </select>

            <label for="dateSelector">Date:</label>
            <input type="date" id="dateSelector" required>

            <label for="periodSelector">Period:</label>
            <select id="periodSelector" required>
                <option value="1">Period 1</option>
                <option value="2">Period 2</option>
                <option value="3">Period 3</option>
                <option value="4">Period 4</option>
                <option value="5">Period 5</option>
                <option value="6">Period 6</option>
            </select>

            <label for="semesterSelector">Semester:</label>
            <select id="semesterSelector" required>
                <option value="1">Semester 1</option>
                <option value="2">Semester 2</option>
                <option value="3">Semester 3</option>
                <option value="4">Semester 4</option>
                <option value="5">Semester 5</option>
                <option value="6">Semester 6</option>
                <option value="7">Semester 7</option>
                <option value="8">Semester 8</option>
            </select>

            <ul id="studentsList">
                <!-- Populate students dynamically based on the selected class -->
            </ul>

            <div id="summarySection">
                <h3>Summary</h3>
                <p>Total Students: <span id="totalStudents">0</span></p>
                <p>Total Present: <span id="totalPresent">0</span></p>
                <p>Total Absent: <span id="totalAbsent">0</span></p>
                <p>Total Leave: <span id="totalLeave">0</span></p>
            </div>

            <button onclick="submitAttendance()">Submit Attendance</button>

            <!-- Result Section -->
            <div id="resultSection">
                <h3>Attendance Result</h3>
                <p>Date: <span id="attendanceDate"></span></p>
                <p>Time: <span id="attendanceTime"></span></p>
                <p>Class: <span id="attendanceClass"></span></p>
                <p>Total Students: <span id="attendanceTotalStudents"></span></p>
                <p>Present: <span id="attendancePresent"></span></p>
                <p>Absent: <span id="attendanceAbsent"></span></p>
                <p>Leave: <span id="attendanceLeave"></span></p>
            </div>
        </div>
    </div>

    <div id="addStudentPopup" class="popup">
        <h2>Add Student</h2>
        <label for="newStudentName">Student Name:</label>
        <input type="text" id="newStudentName" required>
        <label for="newStudentRoll">Roll Number:</label>
        <input type="text" id="newStudentRoll" required>
        <button onclick="addStudent()">Submit</button>
        <button onclick="closePopup('addStudentPopup')">Cancel</button>
    </div>

    <div id="addClassPopup" class="popup">
        <h2>Add Class</h2>
        <label for="newClassName">Class Name:</label>
        <input type="text" id="newClassName" required>
        <button onclick="addClass()">Submit</button>
        <button onclick="closePopup('addClassPopup')">Cancel</button>
    </div>
</div>
    <script>
        function showAddStudentForm() {
            document.getElementById('addStudentPopup').style.display = 'block';
        }

        function showAddClassForm() {
            document.getElementById('addClassPopup').style.display = 'block';
        }

        function closePopup(popupId) {
            document.getElementById(popupId).style.display = 'none';
        }

        function addStudent() {
            const studentName = document.getElementById('newStudentName').value;
            const studentRoll = document.getElementById('newStudentRoll').value;

            if (studentName && studentRoll) {
                const classSelector = document.getElementById('classSelector');
                const selectedClass = classSelector.options[classSelector.selectedIndex].value;

                if (!selectedClass) {
                    alert('Please select a class first.');
                    return;
                }

                const studentsList = document.getElementById('studentsList');
                const studentItem = document.createElement('li');
                studentItem.innerHTML = `${studentName} (Roll No: ${studentRoll}) <select>
                    <option value="present">Present</option>
                    <option value="absent">Absent</option>
                    <option value="leave">Leave</option>
                </select>`;
                studentsList.appendChild(studentItem);

                document.getElementById('newStudentName').value = '';
                document.getElementById('newStudentRoll').value = '';
                closePopup('addStudentPopup');
            } else {
                alert('Please enter all required fields.');
            }
        }

        function addClass() {
            const className = document.getElementById('newClassName').value;

            if (className) {
                const classSelector = document.getElementById('classSelector');
                const newClassOption = document.createElement('option');
                newClassOption.value = className;
                newClassOption.text = className;
                classSelector.add(newClassOption);

                document.getElementById('newClassName').value = '';
                closePopup('addClassPopup');
            } else {
                alert('Please enter a class name.');
            }
        }

        function showStudentsList() {
            const studentsList = document.getElementById('studentsList');
            studentsList.innerHTML = ''; // Clear the list first
            const selectedClass = document.getElementById('classSelector').value;

            // Retrieve students from localStorage
            const studentsData = JSON.parse(localStorage.getItem('studentsData')) || {};
            const classStudents = studentsData[selectedClass] || [];

            classStudents.forEach(student => {
                const studentItem = document.createElement('li');
                studentItem.innerHTML = `${student.name} (Roll No: ${student.roll}) <select>
                    <option value="present">Present</option>
                    <option value="absent">Absent</option>
                    <option value="leave">Leave</option>
                </select>`;
                studentsList.appendChild(studentItem);
            });

            document.getElementById('summarySection').style.display = 'none';
            document.getElementById('resultSection').style.display = 'none';
        }

        function submitAttendance() {
            const classSelector = document.getElementById('classSelector');
            const dateSelector = document.getElementById('dateSelector');
            const periodSelector = document.getElementById('periodSelector');
            const semesterSelector = document.getElementById('semesterSelector');

            const selectedClass = classSelector.value;
            const selectedDate = dateSelector.value;
            const selectedPeriod = periodSelector.value;
            const selectedSemester = semesterSelector.value;

            if (!selectedClass || !selectedDate || !selectedPeriod || !selectedSemester) {
                alert('All fields must be selected.');
                return;
            }

            const studentsList = document.getElementById('studentsList');
            const studentItems = studentsList.getElementsByTagName('li');

            if (studentItems.length === 0) {
                alert('No students found for the selected class.');
                return;
            }

            const attendanceData = JSON.parse(localStorage.getItem('attendanceData')) || [];
            const newAttendanceRecords = [];

            for (let i = 0; i < studentItems.length; i++) {
                const studentItem = studentItems[i];
                const studentName = studentItem.innerText.split(' (Roll No: ')[0];
                const studentRoll = studentItem.innerText.split(' (Roll No: ')[1].split(')')[0];
                const status = studentItem.querySelector('select').value;

                const attendanceRecord = {
                    name: studentName,
                    roll: studentRoll,
                    class: selectedClass,
                    date: selectedDate,
                    period: selectedPeriod,
                    semester: selectedSemester,
                    status: status
                };

                newAttendanceRecords.push(attendanceRecord);
            }

            attendanceData.push(...newAttendanceRecords);
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));

            document.getElementById('summarySection').style.display = 'block';
            document.getElementById('resultSection').style.display = 'none';
            updateSummary();
        }

        function updateSummary() {
            const classSelector = document.getElementById('classSelector').value;
            const dateSelector = document.getElementById('dateSelector').value;
            const periodSelector = document.getElementById('periodSelector').value;
            const semesterSelector = document.getElementById('semesterSelector').value;

            const attendanceData = JSON.parse(localStorage.getItem('attendanceData')) || [];
            const filteredAttendanceData = attendanceData.filter(record =>
                record.class === classSelector &&
                record.date === dateSelector &&
                record.period === periodSelector &&
                record.semester === semesterSelector
            );

            const totalStudents = filteredAttendanceData.length;
            const totalPresent = filteredAttendanceData.filter(record => record.status === 'present').length;
            const totalAbsent = filteredAttendanceData.filter(record => record.status === 'absent').length;
            const totalLeave = filteredAttendanceData.filter(record => record.status === 'leave').length;

            document.getElementById('totalStudents').innerText = totalStudents;
            document.getElementById('totalPresent').innerText = totalPresent;
            document.getElementById('totalAbsent').innerText = totalAbsent;
            document.getElementById('totalLeave').innerText = totalLeave;
        }

        function showAttendanceResult(selectedClass, selectedDate, selectedPeriod, selectedSemester) {
            const resultSection = document.getElementById('resultSection');

            const now = new Date();
            const time = ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')};

            const savedAttendanceData = JSON.parse(localStorage.getItem('attendanceData')) || [];
            const filteredAttendanceData = savedAttendanceData.filter(record =>
                record.class === selectedClass &&
                record.date === selectedDate &&
                record.period === selectedPeriod &&
                record.semester === selectedSemester
            );

            const totalStudents = filteredAttendanceData.length;
            const totalPresent = filteredAttendanceData.filter(record => record.status === 'present').length;
            const totalAbsent = filteredAttendanceData.filter(record => record.status === 'absent').length;
            const totalLeave = filteredAttendanceData.filter(record => record.status === 'leave').length;

            document.getElementById('attendanceDate').innerText = selectedDate;
            document.getElementById('attendanceTime').innerText = time;
            document.getElementById('attendanceClass').innerText = selectedClass;
            document.getElementById('attendanceTotalStudents').innerText = totalStudents;
            document.getElementById('attendancePresent').innerText = totalPresent;
            document.getElementById('attendanceAbsent').innerText = totalAbsent;
            document.getElementById('attendanceLeave').innerText = totalLeave;

            resultSection.style.display = 'block';
        }
    </script>
</body>
</html>